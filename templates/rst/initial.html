<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PSAA Instructor Qualification Record - RST</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='initial.css') }}">
    <style>
        @media print {
            .no-print {
                display: none !important;
            }
        }

        .button-link {
            display: inline-block;
            padding: 10px 20px;
            background-color: #004b8d;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            margin-top: 10px;
        }

        .button-link:hover {
            background-color: #003366;
        }
    </style>
</head>
<body>
<div class="initial-container">

    <!-- Logo -->
    <div class="logo">
        <img src="{{ url_for('static', filename='images/saudia_logo_white.png') }}" alt="Saudia Logo">
    </div>    

    <!-- Title -->
    <h2 class="initial-header">PSAA INSTRUCTOR QUALIFICATION RECORD (INITIAL)</h2>
    <div class="initial-subheader">(Technical Training Instructor - RST)</div>

    <!-- Trainer Info -->
    <div class="instructor-info">
        <p><strong>Name:</strong> {{ trainer[1] }}</p>
        <p><strong>PN:</strong> {{ trainer[2] }}</p>
        <p>
            <strong>Instructor Category:</strong>
            <select name="category">
                <option value="AST" {% if section.upper() == 'AST' %}selected{% endif %}>AST</option>
                <option value="RST" {% if section.upper() == 'RST' %}selected{% endif %}>RST</option>
            </select>
        </p>
        <p><strong>Date:</strong> {{ current_date }}</p>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="flash-message">
        {% for message in messages %}
          <div style="background-color: #d4edda; color: #155724; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% endwith %}

    <!-- Form -->
    <form method="POST" action="{{ url_for('tcfoi_generic', section=section, trainer_id=trainer[0]) }}?source=initial">
        <table class="initial-table">
            <thead>
                <tr>
                    <th>Course (As Applicable)</th>
                    <th>Completion Date</th>
                    <th>Verified By (Name, Signature)</th>
                    <th class="no-print">Action</th>
                </tr>
            </thead>
            <tbody id="course-table">
                {% for row in records %}
                <tr>
                    <td><textarea name="course[]" rows="2" oninput="autoResize(this)" required>{{ row.course }}</textarea></td>
                    <td><input type="date" name="date[]" value="{{ row.date }}" required></td>
                    <td><textarea name="verified[]" rows="2" oninput="autoResize(this)" required>{{ row.verified }}</textarea></td>
                    <td class="no-print"><button type="button" onclick="removeRow(this)">ðŸ—‘</button></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="no-print" style="text-align: right; margin-top: 10px;">
            <button type="button" class="add-row-btn" onclick="addRow()">+ Add Row</button>
        </div>

        <!-- Signature Section -->
        <div class="recommendation-section">
            <label><strong>Manager Technical Training Recommendation:</strong></label>
            <p>To be designated as: <input type="text" name="designation" placeholder="e.g. Avionics Instructor"></p>

            <label>(Name)</label>
            <input type="text" name="manager_name">

            <label>(Signature)</label>
            <input type="text" name="manager_signature">

            <label>Date</label>
            <input type="date" name="manager_date">
        </div>

        <div class="recommendation-section">
            <label><strong>Director Technical Training Approval:</strong></label>
            <p>The recommendation above is approved</p>

            <label>(Name)</label>
            <input type="text" name="director_name">

            <label>(Signature)</label>
            <input type="text" name="director_signature">

            <label>Date</label>
            <input type="date" name="director_date">
        </div>

        <!-- Buttons -->
        <div class="initial-buttons no-print">
            <button type="submit">ðŸ’¾ Submit</button>
            <button type="button" onclick="window.print()">ðŸ–¨ Print</button>
            <a href="{{ url_for('trainer_detail', section=section, trainer_id=trainer[0]) }}" class="button-link">â¬… Back</a>
        </div>
    </form>

    <!-- Footer -->
    <div class="initial-footer">
        <div>PSAA/TT/F01</div>
        <div>{{ current_date }}</div>
    </div>
</div>

<script>
    function addRow() {
        const table = document.getElementById("course-table");
        const row = document.createElement("tr");
        row.innerHTML = `
            <td><textarea name="course[]" rows="2" oninput="autoResize(this)" required></textarea></td>
            <td><input type="date" name="date[]" required></td>
            <td><textarea name="verified[]" rows="2" oninput="autoResize(this)" required></textarea></td>
            <td class="no-print"><button type="button" onclick="removeRow(this)">ðŸ—‘</button></td>
        `;
        table.appendChild(row);
    }

    function removeRow(btn) {
        btn.closest("tr").remove();
    }

    function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
    }
</script>
</body>
</html>
