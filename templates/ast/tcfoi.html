<!-- tcfoi.html (Ù…ÙØ¹Ø¯Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PSAA Instructor Designation Form (TC/F01)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='initial.css') }}">
    <style>
        @media print {
            .no-print {
                display: none !important;
            }
        }

        .button-link {
            display: inline-block;
            padding: 10px 20px;
            background-color: #004b8d;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            margin-top: 10px;
        }

        .button-link:hover {
            background-color: #003366;
        }

        textarea {
            width: 100%;
            resize: vertical;
        }

        /* Ù†ÙØ³ Ø³ØªØ§ÙŠÙ„ initial Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… */
        .instructor-category { text-align: left; margin: 10px 30px; }
        .section-select {
            font-size: 18px;
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
            margin-left: 10px;
        }
        @media print {
            .instructor-category { display:none !important; }
        }
    </style>
</head>
<body>
<div class="initial-container">

    <!-- Logo -->
    <div class="logo">
        <img src="{{ url_for('static', filename='images/saudia_logo_white.png') }}" alt="Saudia Logo">
    </div>

    <!-- Title -->
    <h2 class="initial-header">PSAA INSTRUCTOR DESIGNATION FORM (TC/F01)</h2>
    <div class="initial-subheader">(Technical Training Instructor)</div>

    <!-- Trainer Info -->
    <div class="instructor-info">
        <p><strong>To:</strong> {{ trainer[1] }}</p>
        <p><strong>From:</strong> Director of Technical Training</p>
        <p><strong>Date:</strong> {{ current_date }}</p>
        <p><strong>Subject:</strong> Designation</p>
        <p><strong>Dear:</strong> {{ trainer[1] }}</p>
    </div>

        <!-- Instructor Category (Ù†ÙØ³ initial) -->
        <div class="instructor-category no-print">
        <label><strong>Instructor Category:</strong>
                <!-- Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ù€ lowercase Ù„Ø£Ù† Ø§Ù„Ø±Ø§ÙˆØª ÙŠØ³ØªØ®Ø¯Ù… /tcfoi/<section>/ -->
                <select class="section-select" onchange="redirectToSection(this.value)">
                    <option value="ast" {% if section|lower == 'ast' %}selected{% endif %}>AST</option>
                    <option value="rst" {% if section|lower == 'rst' %}selected{% endif %}>RST</option>
                </select>
            </label>
        </div>
    
    <!-- Form -->
    <form method="POST" action="{{ url_for('tcfoi_generic', section=section, trainer_id=trainer[0]) }}?source={{ request.args.get('source', '') }}">
        <table class="initial-table">
            <thead>
                <tr>
                    <th>Instructor</th>
                    <th>Designation</th>
                    <th class="no-print">Delete</th>
                </tr>
            </thead>
            <tbody id="tcfoi-table">
                <tr>
                    <td rowspan="1000">
                        <textarea name="instructor_main" rows="8" oninput="autoResize(this)" required>{{ instructor_main if instructor_main else '' }}</textarea>
                    </td>
                    <td><textarea name="designation[]" rows="2" oninput="autoResize(this)" required>{{ records[0].designation if records|length > 0 else '' }}</textarea></td>
                    <td class="no-print"><button type="button" onclick="removeRow(this)">ğŸ—‘</button></td>
                </tr>
                {% for row in records[1:] %}
                <tr>
                    <td><textarea name="designation[]" rows="2" oninput="autoResize(this)" required>{{ row.designation }}</textarea></td>
                    <td class="no-print"><button type="button" onclick="removeRow(this)">ğŸ—‘</button></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="no-print" style="text-align: right; margin-top: 10px;">
            <button type="button" class="add-row-btn" onclick="addRow()">+ Add Row</button>
        </div>

        <!-- Signature Section -->
        <div class="recommendation-section">
            <label><strong>Director Technical Training Approval:</strong></label>
            <label>(Name)</label>
            <input type="text" name="director_name" required>
            <label>(Signature)</label>
            <input type="text" name="director_signature" required>
            <label>Date</label>
            <input type="date" name="director_date" required>
        </div>

        <!-- Buttons -->
        <div class="initial-buttons no-print">
            <button type="submit">ğŸ’¾ Submit</button>
            <button type="button" onclick="window.print()">ğŸ–¨ Print</button>
            <!-- Back Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… PN (trainer[2]) Ù„Ø£Ù† Ù…Ø³Ø§Ø± trainer_detail ÙŠØ³ØªÙ‚Ø¨Ù„ pn -->
            <a href="{{ url_for('trainer_detail', section=section, trainer_id=trainer[2]) }}" class="button-link">â¬… Back</a>
        </div>
    </form>

    <!-- Footer -->
    <div class="initial-footer">
        <div>PSAA/TC/F01</div>
        <div>12APR2021</div>
    </div>
</div>

<!-- Scripts -->
<script>
    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ø³Ù… Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ query string (Ù…Ø«Ù„ source)
    function redirectToSection(newSection) {
        var trainerId = "{{ trainer[0] }}"; // id Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ
        var qs = window.location.search || ""; // ÙŠØ­ÙØ¸ ?source=...
        // ÙŠØ¨Ù‚Ù‰ Ø¹Ù„Ù‰ Ù†ÙØ³ ØµÙØ­Ø© tcfoi Ù„ÙƒÙ† ÙŠØ¨Ø¯Ù‘Ù„ Ø§Ù„Ù‚Ø³Ù…
        var target = "/tcfoi/" + newSection + "/" + trainerId + qs;
        window.location.href = target;
    }

    function addRow() {
        const table = document.getElementById("tcfoi-table");
        const row = document.createElement("tr");
        row.innerHTML = `
            <td><textarea name="designation[]" rows="2" oninput="autoResize(this)" required></textarea></td>
            <td class="no-print"><button type="button" onclick="removeRow(this)">ğŸ—‘</button></td>
        `;
        table.appendChild(row);
    }

    function removeRow(btn) {
        btn.closest("tr").remove();
    }

    function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
    }
</script>
</body>
</html>
